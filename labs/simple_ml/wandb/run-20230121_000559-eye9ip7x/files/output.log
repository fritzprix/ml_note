Found cached dataset wikitext (/home/fritzprix/.cache/huggingface/datasets/wikitext/wikitext-2-v1/1.0.0/a241db52902eaf2c6aa732210bead40c090019a499ceb13bcbfa3f8ab646a126)
100%|███████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 1524.09it/s]
Loading cached processed dataset at /home/fritzprix/.cache/huggingface/datasets/wikitext/wikitext-2-v1/1.0.0/a241db52902eaf2c6aa732210bead40c090019a499ceb13bcbfa3f8ab646a126/cache-fa4a4a4c04b58af6.arrow
Loading cached processed dataset at /home/fritzprix/.cache/huggingface/datasets/wikitext/wikitext-2-v1/1.0.0/a241db52902eaf2c6aa732210bead40c090019a499ceb13bcbfa3f8ab646a126/cache-73a6c9a57c86a67d.arrow
Loading cached processed dataset at /home/fritzprix/.cache/huggingface/datasets/wikitext/wikitext-2-v1/1.0.0/a241db52902eaf2c6aa732210bead40c090019a499ceb13bcbfa3f8ab646a126/cache-bc1a7a2911056c2f.arrow
Loading cached processed dataset at /home/fritzprix/.cache/huggingface/datasets/wikitext/wikitext-2-v1/1.0.0/a241db52902eaf2c6aa732210bead40c090019a499ceb13bcbfa3f8ab646a126/cache-9634a13e6ffdf5e0.arrow
Loading cached processed dataset at /home/fritzprix/.cache/huggingface/datasets/wikitext/wikitext-2-v1/1.0.0/a241db52902eaf2c6aa732210bead40c090019a499ceb13bcbfa3f8ab646a126/cache-9336f4e4a9353ff3.arrow
Found cached dataset wikitext (/home/fritzprix/.cache/huggingface/datasets/wikitext/wikitext-2-v1/1.0.0/a241db52902eaf2c6aa732210bead40c090019a499ceb13bcbfa3f8ab646a126)
100%|███████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00, 2154.61it/s]
Loading cached processed dataset at /home/fritzprix/.cache/huggingface/datasets/wikitext/wikitext-2-v1/1.0.0/a241db52902eaf2c6aa732210bead40c090019a499ceb13bcbfa3f8ab646a126/cache-29738f630967d57d.arrow
Loading cached processed dataset at /home/fritzprix/.cache/huggingface/datasets/wikitext/wikitext-2-v1/1.0.0/a241db52902eaf2c6aa732210bead40c090019a499ceb13bcbfa3f8ab646a126/cache-b79c4c83bb14680a.arrow
Loading cached processed dataset at /home/fritzprix/.cache/huggingface/datasets/wikitext/wikitext-2-v1/1.0.0/a241db52902eaf2c6aa732210bead40c090019a499ceb13bcbfa3f8ab646a126/cache-a1225151a901c50c.arrow
Loading cached processed dataset at /home/fritzprix/.cache/huggingface/datasets/wikitext/wikitext-2-v1/1.0.0/a241db52902eaf2c6aa732210bead40c090019a499ceb13bcbfa3f8ab646a126/cache-9d81e13af7799ec0.arrow
Loading cached processed dataset at /home/fritzprix/.cache/huggingface/datasets/wikitext/wikitext-2-v1/1.0.0/a241db52902eaf2c6aa732210bead40c090019a499ceb13bcbfa3f8ab646a126/cache-10d9f5da79a9bb60.arrow
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/home/fritzprix/miniconda3/envs/directml/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:604: UserWarning: Checkpoint directory /home/fritzprix/my_work/ml_note/labs/simple_ml/model/gru_ml exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
  | Name      | Type      | Params
----------------------------------------
0 | gru       | GRU       | 20.9 K
1 | fc        | Linear    | 6.0 K
2 | embedding | Embedding | 81.2 K
3 | loss      | MSELoss   | 0
----------------------------------------
26.9 K    Trainable params
81.2 K    Non-trainable params
108 K     Total params
0.433     Total estimated model params size (MB)
Sanity Checking DataLoader 0:   0%|                                                   | 0/2 [00:00<?, ?it/s]tensor([[[0.0031, 0.0032, 0.0026,  ..., 0.0045, 0.0031, 0.0034],
         [0.0034, 0.0030, 0.0024,  ..., 0.0050, 0.0029, 0.0030],
         [0.0039, 0.0029, 0.0025,  ..., 0.0046, 0.0030, 0.0030],
         ...,
         [0.0032, 0.0030, 0.0026,  ..., 0.0046, 0.0033, 0.0031],
         [0.0032, 0.0030, 0.0026,  ..., 0.0046, 0.0033, 0.0031],
         [0.0032, 0.0030, 0.0026,  ..., 0.0046, 0.0033, 0.0031]],
        [[0.0036, 0.0029, 0.0029,  ..., 0.0040, 0.0032, 0.0032],
         [0.0034, 0.0026, 0.0031,  ..., 0.0043, 0.0029, 0.0032],
         [0.0036, 0.0025, 0.0029,  ..., 0.0051, 0.0027, 0.0028],
         ...,
         [0.0034, 0.0025, 0.0027,  ..., 0.0044, 0.0031, 0.0031],
         [0.0035, 0.0024, 0.0025,  ..., 0.0053, 0.0028, 0.0030],
         [0.0031, 0.0025, 0.0028,  ..., 0.0049, 0.0034, 0.0032]],
        [[0.0031, 0.0032, 0.0026,  ..., 0.0045, 0.0031, 0.0034],
         [0.0034, 0.0030, 0.0024,  ..., 0.0050, 0.0029, 0.0030],
         [0.0034, 0.0030, 0.0022,  ..., 0.0053, 0.0029, 0.0029],
         ...,
         [0.0032, 0.0030, 0.0026,  ..., 0.0046, 0.0033, 0.0031],
         [0.0032, 0.0030, 0.0026,  ..., 0.0046, 0.0033, 0.0031],
         [0.0032, 0.0030, 0.0026,  ..., 0.0046, 0.0033, 0.0031]],
        ...,
        [[0.0031, 0.0027, 0.0025,  ..., 0.0039, 0.0033, 0.0030],
         [0.0026, 0.0028, 0.0027,  ..., 0.0035, 0.0035, 0.0032],
         [0.0031, 0.0026, 0.0030,  ..., 0.0043, 0.0038, 0.0028],
         ...,
         [0.0034, 0.0026, 0.0031,  ..., 0.0039, 0.0041, 0.0027],
         [0.0034, 0.0028, 0.0031,  ..., 0.0038, 0.0045, 0.0026],
         [0.0036, 0.0030, 0.0034,  ..., 0.0041, 0.0044, 0.0027]],
        [[0.0029, 0.0032, 0.0030,  ..., 0.0037, 0.0033, 0.0033],
         [0.0028, 0.0031, 0.0028,  ..., 0.0033, 0.0033, 0.0032],
         [0.0031, 0.0024, 0.0025,  ..., 0.0039, 0.0033, 0.0026],
         ...,
         [0.0029, 0.0027, 0.0029,  ..., 0.0038, 0.0037, 0.0033],
         [0.0029, 0.0027, 0.0029,  ..., 0.0038, 0.0035, 0.0032],
         [0.0034, 0.0024, 0.0026,  ..., 0.0042, 0.0035, 0.0027]],
        [[0.0031, 0.0032, 0.0026,  ..., 0.0045, 0.0031, 0.0034],
         [0.0034, 0.0030, 0.0024,  ..., 0.0050, 0.0029, 0.0030],
         [0.0034, 0.0030, 0.0022,  ..., 0.0053, 0.0029, 0.0029],
         ...,
         [0.0032, 0.0030, 0.0026,  ..., 0.0046, 0.0033, 0.0031],
         [0.0032, 0.0030, 0.0026,  ..., 0.0046, 0.0033, 0.0031],
         [0.0032, 0.0030, 0.0026,  ..., 0.0046, 0.0033, 0.0031]]],
       device='cuda:0') tensor([[[-0.1200, -0.1007, -0.3052,  ...,  0.2464, -0.1254, -0.0167],
         [-0.0244, -0.1400, -0.3717,  ...,  0.3659, -0.1762, -0.1562],
         [ 0.1025, -0.1713, -0.3436,  ...,  0.2877, -0.1609, -0.1537],
         ...,
         [-0.0647, -0.1518, -0.2976,  ...,  0.2865, -0.0619, -0.1007],
         [-0.0646, -0.1521, -0.2974,  ...,  0.2865, -0.0619, -0.1007],
         [-0.0645, -0.1523, -0.2973,  ...,  0.2864, -0.0618, -0.1007]],
        [[ 0.0365, -0.1985, -0.1772,  ...,  0.1383, -0.0716, -0.0937],
         [-0.0233, -0.2780, -0.1074,  ...,  0.2116, -0.1887, -0.0794],
         [ 0.0570, -0.3114, -0.1581,  ...,  0.3926, -0.2288, -0.1936],
         ...,
         [-0.0289, -0.3243, -0.2639,  ...,  0.2360, -0.1144, -0.1063],
         [ 0.0007, -0.3648, -0.3182,  ...,  0.4237, -0.1997, -0.1313],
         [-0.1200, -0.3104, -0.1957,  ...,  0.3548, -0.0288, -0.0624]],
        [[-0.1200, -0.1007, -0.3052,  ...,  0.2464, -0.1254, -0.0167],
         [-0.0244, -0.1400, -0.3717,  ...,  0.3659, -0.1762, -0.1562],
         [-0.0111, -0.1454, -0.4325,  ...,  0.4264, -0.1862, -0.1841],
         ...,
         [-0.0645, -0.1520, -0.2976,  ...,  0.2865, -0.0619, -0.1008],
         [-0.0645, -0.1522, -0.2974,  ...,  0.2865, -0.0618, -0.1008],
         [-0.0644, -0.1524, -0.2973,  ...,  0.2864, -0.0618, -0.1008]],
        ...,
        [[-0.1255, -0.2698, -0.3221,  ...,  0.1172, -0.0538, -0.1480],
         [-0.2911, -0.2161, -0.2583,  ..., -0.0031,  0.0053, -0.0855],
         [-0.1079, -0.2684, -0.1512,  ...,  0.2100,  0.0898, -0.2242],
         ...,
         [-0.0263, -0.2763, -0.1121,  ...,  0.1157,  0.1664, -0.2390],
         [-0.0148, -0.2088, -0.1096,  ...,  0.0958,  0.2695, -0.2697],
         [ 0.0612, -0.1295, -0.0074,  ...,  0.1843,  0.2562, -0.2556]],
        [[-0.1756, -0.0997, -0.1438,  ...,  0.0546, -0.0664, -0.0622],
         [-0.2136, -0.1238, -0.2090,  ..., -0.0454, -0.0506, -0.0971],
         [-0.1169, -0.3606, -0.3309,  ...,  0.1194, -0.0599, -0.2726],
         ...,
         [-0.1808, -0.2472, -0.1642,  ...,  0.0998,  0.0768, -0.0441],
         [-0.1811, -0.2294, -0.1829,  ...,  0.0987,  0.0050, -0.0758],
         [-0.0078, -0.3521, -0.2823,  ...,  0.1853,  0.0019, -0.2497]],
        [[-0.1200, -0.1007, -0.3052,  ...,  0.2464, -0.1254, -0.0167],
         [-0.0244, -0.1400, -0.3717,  ...,  0.3659, -0.1762, -0.1562],
         [-0.0111, -0.1454, -0.4325,  ...,  0.4264, -0.1862, -0.1841],
         ...,
         [-0.0646, -0.1521, -0.2974,  ...,  0.2865, -0.0619, -0.1007],
         [-0.0645, -0.1523, -0.2973,  ...,  0.2864, -0.0618, -0.1007],
         [-0.0645, -0.1524, -0.2972,  ...,  0.2864, -0.0618, -0.1007]]],
       device='cuda:0')
Sanity Checking DataLoader 0:  50%|█████████████████████▌                     | 1/2 [00:00<00:00,  7.38it/s]tensor([[[0.0031, 0.0027, 0.0024,  ..., 0.0043, 0.0030, 0.0035],
         [0.0029, 0.0027, 0.0029,  ..., 0.0050, 0.0030, 0.0041],
         [0.0032, 0.0024, 0.0028,  ..., 0.0045, 0.0031, 0.0033],
         ...,
         [0.0032, 0.0028, 0.0031,  ..., 0.0045, 0.0038, 0.0029],
         [0.0034, 0.0028, 0.0030,  ..., 0.0045, 0.0038, 0.0027],
         [0.0032, 0.0029, 0.0028,  ..., 0.0043, 0.0036, 0.0030]],
        [[0.0029, 0.0032, 0.0030,  ..., 0.0037, 0.0033, 0.0033],
         [0.0032, 0.0030, 0.0028,  ..., 0.0039, 0.0031, 0.0030],
         [0.0034, 0.0028, 0.0029,  ..., 0.0046, 0.0029, 0.0027],
         ...,
         [0.0033, 0.0031, 0.0033,  ..., 0.0038, 0.0036, 0.0027],
         [0.0034, 0.0026, 0.0030,  ..., 0.0044, 0.0035, 0.0023],
         [0.0029, 0.0025, 0.0030,  ..., 0.0043, 0.0037, 0.0026]],
        [[0.0031, 0.0030, 0.0031,  ..., 0.0037, 0.0034, 0.0036],
         [0.0033, 0.0034, 0.0031,  ..., 0.0041, 0.0032, 0.0039],
         [0.0028, 0.0034, 0.0031,  ..., 0.0038, 0.0035, 0.0043],
         ...,
         [0.0032, 0.0027, 0.0027,  ..., 0.0040, 0.0032, 0.0032],
         [0.0029, 0.0029, 0.0028,  ..., 0.0040, 0.0030, 0.0033],
         [0.0025, 0.0034, 0.0026,  ..., 0.0036, 0.0029, 0.0033]],
        ...,
        [[0.0034, 0.0027, 0.0029,  ..., 0.0042, 0.0033, 0.0032],
         [0.0031, 0.0026, 0.0031,  ..., 0.0047, 0.0033, 0.0037],
         [0.0029, 0.0028, 0.0030,  ..., 0.0043, 0.0037, 0.0036],
         ...,
         [0.0034, 0.0025, 0.0030,  ..., 0.0053, 0.0034, 0.0030],
         [0.0033, 0.0024, 0.0031,  ..., 0.0053, 0.0035, 0.0027],
         [0.0034, 0.0023, 0.0030,  ..., 0.0054, 0.0035, 0.0023]],
        [[0.0031, 0.0028, 0.0030,  ..., 0.0041, 0.0033, 0.0033],
         [0.0033, 0.0025, 0.0027,  ..., 0.0037, 0.0036, 0.0031],
         [0.0032, 0.0027, 0.0025,  ..., 0.0032, 0.0036, 0.0032],
         ...,
         [0.0031, 0.0029, 0.0026,  ..., 0.0041, 0.0036, 0.0036],
         [0.0031, 0.0028, 0.0026,  ..., 0.0040, 0.0034, 0.0034],
         [0.0032, 0.0029, 0.0025,  ..., 0.0038, 0.0033, 0.0033]],
        [[0.0031, 0.0032, 0.0026,  ..., 0.0045, 0.0031, 0.0034],
         [0.0034, 0.0030, 0.0024,  ..., 0.0050, 0.0029, 0.0030],
         [0.0034, 0.0030, 0.0022,  ..., 0.0053, 0.0029, 0.0029],
         ...,
         [0.0033, 0.0029, 0.0022,  ..., 0.0057, 0.0026, 0.0030],
         [0.0033, 0.0030, 0.0022,  ..., 0.0051, 0.0028, 0.0030],
         [0.0032, 0.0030, 0.0022,  ..., 0.0048, 0.0030, 0.0031]]],
       device='cuda:0') tensor([[[-1.1466e-01, -2.5802e-01, -3.6132e-01,  ...,  2.1593e-01,
          -1.6177e-01,  1.2627e-02],
         [-1.7928e-01, -2.6025e-01, -1.9545e-01,  ...,  3.6053e-01,
          -1.5611e-01,  1.6032e-01],
         [-7.3703e-02, -3.6674e-01, -2.3258e-01,  ...,  2.6241e-01,
          -1.0122e-01, -5.0475e-02],
         ...,
         [-4.4432e-02, -1.8007e-01, -1.0258e-01,  ...,  2.8172e-01,
           1.1446e-01, -1.4445e-01],
         [-4.9302e-03, -2.0061e-01, -1.1733e-01,  ...,  2.7461e-01,
           1.0649e-01, -2.3219e-01],
         [-7.0048e-02, -1.7131e-01, -1.9442e-01,  ...,  2.1879e-01,
           6.0008e-02, -1.3240e-01]],
        [[-1.7560e-01, -9.9664e-02, -1.4385e-01,  ...,  5.4608e-02,
          -6.6364e-02, -6.2180e-02],
         [-7.2288e-02, -1.3731e-01, -2.2101e-01,  ...,  1.2097e-01,
          -1.0627e-01, -1.5286e-01],
         [-1.4677e-02, -2.0843e-01, -1.9209e-01,  ...,  2.8236e-01,
          -1.7374e-01, -2.6488e-01],
         ...,
         [-5.3679e-02, -1.1681e-01, -3.4953e-02,  ...,  1.0329e-01,
           5.9131e-02, -2.5718e-01],
         [-1.4733e-02, -2.9183e-01, -1.4515e-01,  ...,  2.5781e-01,
           1.1537e-02, -3.8377e-01],
         [-1.7950e-01, -3.3672e-01, -1.3984e-01,  ...,  2.1689e-01,
           6.2789e-02, -2.8351e-01]],
        [[-1.3261e-01, -1.5613e-01, -1.1979e-01,  ...,  5.5129e-02,
          -2.6515e-02,  2.8766e-02],
         [-6.5779e-02, -3.3328e-02, -1.0621e-01,  ...,  1.7182e-01,
          -7.9846e-02,  1.0474e-01],
         [-2.2532e-01, -1.4445e-02, -1.1074e-01,  ...,  9.3736e-02,
           4.4428e-05,  2.0965e-01],
         ...,
         [-8.7493e-02, -2.4916e-01, -2.6841e-01,  ...,  1.4428e-01,
          -7.5517e-02, -7.6940e-02],
         [-1.7763e-01, -1.8408e-01, -2.0109e-01,  ...,  1.4866e-01,
          -1.5720e-01, -4.0643e-02],
         [-3.0749e-01, -9.0701e-03, -2.9220e-01,  ...,  3.6922e-02,
          -1.7645e-01, -2.8772e-02]],
        ...,
        [[-3.2258e-02, -2.3982e-01, -1.8000e-01,  ...,  1.8443e-01,
          -4.2093e-02, -9.8294e-02],
         [-1.1647e-01, -2.9528e-01, -1.1711e-01,  ...,  3.1017e-01,
          -4.4748e-02,  7.4141e-02],
         [-1.6953e-01, -1.9711e-01, -1.3853e-01,  ...,  2.0901e-01,
           7.6836e-02,  5.0140e-02],
         ...,
         [-1.8619e-02, -3.4005e-01, -1.3585e-01,  ...,  4.3227e-01,
          -3.2659e-04, -1.4628e-01],
         [-2.2151e-02, -3.6432e-01, -9.3704e-02,  ...,  4.3677e-01,
           3.2079e-02, -2.3544e-01],
         [ 3.8650e-03, -3.8654e-01, -1.1957e-01,  ...,  4.5236e-01,
           1.9277e-02, -3.7423e-01]],
        [[-1.1417e-01, -2.2865e-01, -1.5187e-01,  ...,  1.5411e-01,
          -6.5827e-02, -4.2852e-02],
         [-5.5710e-02, -3.3831e-01, -2.6141e-01,  ...,  7.1191e-02,
           3.4421e-02, -1.1024e-01],
         [-8.4868e-02, -2.5431e-01, -3.1968e-01,  ..., -6.5160e-02,
           3.2907e-02, -6.9988e-02],
         ...,
         [-9.8067e-02, -1.7312e-01, -2.9069e-01,  ...,  1.7700e-01,
           4.9500e-02,  4.4398e-02],
         [-9.9887e-02, -1.9116e-01, -2.8404e-01,  ...,  1.5605e-01,
          -1.2448e-02, -1.7151e-03],
         [-8.1492e-02, -1.7543e-01, -3.3492e-01,  ...,  9.6828e-02,
          -5.6658e-02, -4.9604e-02]],
        [[-1.1997e-01, -1.0068e-01, -3.0519e-01,  ...,  2.4636e-01,
          -1.2545e-01, -1.6668e-02],
         [-2.4366e-02, -1.3998e-01, -3.7165e-01,  ...,  3.6588e-01,
          -1.7617e-01, -1.5625e-01],
         [-1.1060e-02, -1.4538e-01, -4.3249e-01,  ...,  4.2641e-01,
          -1.8621e-01, -1.8414e-01],
         ...,
         [-3.9071e-02, -1.5410e-01, -4.5384e-01,  ...,  5.0094e-01,
          -2.7263e-01, -1.5273e-01],
         [-5.3236e-02, -1.4564e-01, -4.7426e-01,  ...,  3.9655e-01,
          -2.1656e-01, -1.2856e-01],
         [-6.6216e-02, -1.4230e-01, -4.5482e-01,  ...,  3.2381e-01,
          -1.6232e-01, -1.0326e-01]]], device='cuda:0')
Epoch 0:   2%|▌                                     | 4/263 [00:02<03:00,  1.44it/s, loss=0.843, v_num=ip7x]
Epoch 0:   2%|▌                                     | 4/263 [00:02<03:00,  1.44it/s, loss=0.843, v_num=ip7x]
Epoch 0:   2%|▌                                     | 4/263 [00:02<03:00,  1.44it/s, loss=0.843, v_num=ip7x]
/home/fritzprix/miniconda3/envs/directml/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py:48: UserWarning: Detected KeyboardInterrupt, attempting graceful shutdown...
  rank_zero_warn("Detected KeyboardInterrupt, attempting graceful shutdown...")
Epoch 0:   2%|▌                                     | 4/263 [00:02<03:00,  1.44it/s, loss=0.843, v_num=ip7x]